# Matter Tracker Application Setup Instructions

## Prerequisites
- Node.js (v16 or higher)
- PostgreSQL database
- npm or yarn

## Project Description

We are building a matter tracker app for attorneys that will track their time based on self reported estimates, 
and corrected times expressed in percentages of their work time or in minutes).  The attorneys generally do this weekly , estimating the coming week of expected times on various tasks, and also reporting on previous week with corrected approximations of their time that was spent on various tasks to the best of their recollection.  They are used to doing this weekly, so we want that to be a prominent feature of the user interace, but we also want to support more flexibility in time periods for which they can estimate the future time and correct their estimates after having performed the tasks.  We will have a daily timesheet as well which we will demonstrate and attach more advanced features to fill in estimates of time.

We also want to integrate data that expresses real activities performed by the attorneys for comparison, and use this to fill out the actual time spent on tasks by correlating the real time data to the timesheet data.

We expect we can pull data on these various activities, correlate to matters and tasks and make available for analysis:
- Creation and modification of files like word documents stored on Microsoft One Drive and through Graph API
- Meetings scheduled in outlook calendars
- Emails sent and received, correlated to client matters
- LLM chat logs that are correlated to matters and tasks
- Data from the aderant milana system on real dates for court events, etc., combined with modeled task templates with dependency tree to create other tasks in system to be scheduled in order to make court dates and other dates where communication with external entities and firms is required.

There are three major categories of activities, matters (time spent on client cases), pro bono work, and internal activities (firm meetings, administrative time, etc.)  So tasks can be part of client matters, pro bono, or internal activities.  We will want to start simple with tasks, just defining standard tasks through an admin interface and client matters that can be selected by the attorney in drop down boxes to estimate their time which is expressed in percentages of their total week (or whatever period is being estimated in a more advanced version).

Over time we might implement more advanced project management features like task dependencies and hierarchies of tasks and subtasks, but we want to start out simple to have a clean and simple interface that is very intuitive and quick for the attorneys to use to encourage usage.  We do not want the attorneys to feel we are tracking their activities down to the minute to make them feel self conscious of how they are reporting their data, but rather make it feel like an aid that will help the firm reallocate tasks as needed for a busy schedule of a fast growing company.



## Project Structure
```
matter-tracker/
+-- backend/
¦   +-- prisma/
¦   ¦   +-- migrations/          # Auto-generated by Prisma
¦   ¦   +-- schema.prisma
¦   ¦   +-- seed.ts
¦   ¦   +-- seeds/
¦   ¦       +-- clients.json
¦   ¦       +-- matters.json
¦   ¦       +-- teamMembers.json
¦   ¦       +-- tasks.json
¦   +-- src/
¦   ¦   +-- routes/
¦   ¦   ¦   +-- timesheet.routes.ts
¦   ¦   ¦   +-- matter.routes.ts
¦   ¦   ¦   +-- teamMember.routes.ts
¦   ¦   ¦   +-- task.routes.ts
¦   ¦   +-- server.ts
¦   +-- dist/                    # Build output directory
¦   +-- node_modules/
¦   +-- package.json
¦   +-- package-lock.json
¦   +-- tsconfig.json
¦   +-- .env
+-- frontend/
¦   +-- public/                  # Static assets
¦   ¦   +-- favicon.ico
¦   +-- src/
¦   ¦   +-- assets/             # Images, fonts, etc.
¦   ¦   +-- boot/               # Boot files (app initialization)
¦   ¦   ¦   +-- axios.ts        # Axios configuration
¦   ¦   +-- components/
¦   ¦   ¦   +-- MatterDialog.vue
¦   ¦   +-- css/                # Global CSS/SCSS
¦   ¦   ¦   +-- app.scss
¦   ¦   ¦   +-- quasar.variables.scss
¦   ¦   +-- layouts/
¦   ¦   ¦   +-- MainLayout.vue
¦   ¦   +-- pages/
¦   ¦   ¦   +-- TimesheetPage.vue
¦   ¦   ¦   +-- ErrorNotFound.vue
¦   ¦   +-- router/
¦   ¦   ¦   +-- index.ts        # Router configuration
¦   ¦   ¦   +-- routes.ts       # Route definitions
¦   ¦   +-- services/
¦   ¦   ¦   +-- api.ts
¦   ¦   +-- types/
¦   ¦   ¦   +-- models.ts
¦   ¦   +-- App.vue
¦   +-- src-pwa/                # PWA specific files (if enabled)
¦   +-- dist/                   # Build output directory
¦   +-- node_modules/
¦   +-- .gitignore
¦   +-- .eslintrc.js
¦   +-- index.html              # Entry HTML template
¦   +-- package.json
¦   +-- package-lock.json
¦   +-- quasar.config.js        # Main Quasar configuration
¦   +-- tsconfig.json
¦   +-- .env
+-- docker-compose.yml          # PostgreSQL Docker configuration
+-- README.md
```


## Project Structure (original)
```
matter-tracker/
+-- backend/
¦   +-- prisma/
¦   ¦   +-- schema.prisma
¦   ¦   +-- seed.ts
¦   ¦   +-- seeds/
¦   ¦       +-- clients.json
¦   ¦       +-- matters.json
¦   ¦       +-- teamMembers.json
¦   ¦       +-- tasks.json
¦   +-- src/
¦   ¦   +-- routes/
¦   ¦   ¦   +-- timesheet.routes.ts
¦   ¦   ¦   +-- matter.routes.ts
¦   ¦   ¦   +-- teamMember.routes.ts
¦   ¦   ¦   +-- task.routes.ts
¦   ¦   +-- server.ts
¦   +-- package.json
¦   +-- tsconfig.json
¦   +-- .env
+-- frontend/
¦   +-- src/
¦   ¦   +-- components/
¦   ¦   ¦   +-- MatterDialog.vue
¦   ¦   +-- layouts/
¦   ¦   ¦   +-- MainLayout.vue
¦   ¦   +-- pages/
¦   ¦   ¦   +-- TimesheetPage.vue
¦   ¦   +-- router/
¦   ¦   ¦   +-- routes.ts
¦   ¦   +-- services/
¦   ¦   ¦   +-- api.ts
¦   ¦   +-- types/
¦   ¦   ¦   +-- models.ts
¦   ¦   +-- App.vue
¦   ¦   +-- main.ts
¦   +-- public/
¦   ¦   +-- index.html
¦   +-- package.json
¦   +-- tsconfig.json
¦   +-- quasar.conf.js
¦   +-- .env
+-- README.md
```

## Backend Setup

### 1. Initialize Backend
```bash
cd backend
npm init -y
npm install express cors dotenv
npm install @prisma/client
npm install -D @types/express @types/cors @types/node typescript nodemon ts-node prisma
```

### 2. Create tsconfig.json
```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "commonjs",
    "lib": ["ES2020"],
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "resolveJsonModule": true,
    "moduleResolution": "node"
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules"]
}
```

### 3. Create .env file
```env
DATABASE_URL="postgresql://username:password@localhost:5432/mattertracker_db"
PORT=3000
```

### 4. Update package.json scripts
```json
{
  "scripts": {
    "dev": "nodemon src/server.ts",
    "build": "tsc",
    "start": "node dist/server.js",
    "prisma:generate": "prisma generate",
    "prisma:migrate": "prisma migrate dev",
    "prisma:seed": "ts-node prisma/seed.ts",
    "setup": "npm run prisma:generate && npm run prisma:migrate && npm run prisma:seed"
  }
}
```

### 5. Setup Database
```bash
# Generate Prisma client
npm run prisma:generate

# Create and run migrations
npm run prisma:migrate -- --name init

# Seed the database
npm run prisma:seed
```

### 6. Start Backend Server
```bash
npm run dev
```

## Frontend Setup

### 1. Initialize Quasar Project
```bash
npm install -g @quasar/cli
quasar create frontend

# Choose:
# - Quasar v2 (Vue 3)
# - TypeScript
# - Composition API
# - ESLint + Prettier
```

### 2. Install Additional Dependencies
```bash
cd frontend
npm install axios
npm install -D @types/node
```

### 3. Create .env file
```env
VUE_APP_API_URL=http://localhost:3000/api
```

### 4. Copy the provided files
Copy all the Vue components, TypeScript files, and configurations to their respective directories as shown in the project structure.

### 5. Update quasar.conf.js
Replace the default quasar.conf.js with the provided configuration.

### 6. Start Frontend Development Server
```bash
quasar dev
```

## Usage

1. **Access the application** at `http://localhost:8080`

2. **Select a Team Member** from the dropdown

3. **Navigate weeks** using the arrow buttons or calendar picker

4. **Add time entries**:
   - Click "Add Entry" to add a new row
   - Select a matter from the dropdown
   - Enter or select a task description
   - Choose urgency level (Hot, Medium, Mild)
   - Enter projected and actual hours as percentages
   - Hours must total 100% for both projected and actual

5. **Save your timesheet** by clicking the Save button

6. **Copy from last week** to quickly populate the current week with previous week's data

7. **Add new matters** by clicking the + button in the header

## Features

- **Week-based time tracking** with Sunday as the start of the week
- **Percentage-based hours** with automatic calculation to actual hours
- **Matter and task management** with dropdown suggestions
- **Validation** to ensure data integrity
- **Copy from previous week** functionality
- **Responsive design** using Quasar components
- **Real-time totals** calculation
- **Hover tooltips** showing actual hours based on team member's working hours

## API Endpoints

### Timesheets
- `GET /api/timesheets/:teamMemberId/:weekStartDate` - Get timesheet for a specific week
- `POST /api/timesheets/:teamMemberId/:weekStartDate` - Save timesheet entries
- `POST /api/timesheets/:teamMemberId/:weekStartDate/copy-from-previous` - Copy from previous week

### Matters
- `GET /api/matters` - Get all matters
- `POST /api/matters` - Create new matter

### Team Members
- `GET /api/team-members` - Get all team members

### Tasks
- `GET /api/tasks/matter/:matterId` - Get tasks for a specific matter

## Troubleshooting

### Database Connection Issues
- Ensure PostgreSQL is running
- Check DATABASE_URL in .env file
- Verify database exists: `createdb timesheet_db`

### CORS Issues
- Backend CORS is configured to accept all origins in development
- For production, update CORS settings in server.ts

### Build Issues
- Clear node_modules and reinstall: `rm -rf node_modules && npm install`
- Ensure TypeScript version compatibility
- Check for port conflicts (3000 for backend, 8080 for frontend)

## Production Deployment

### Backend
1. Build: `npm run build`
2. Set production DATABASE_URL
3. Run migrations: `npm run prisma:migrate deploy`
4. Start: `npm start`

### Frontend
1. Build: `quasar build`
2. Deploy dist/spa directory to your web server
3. Configure API_URL for production

## Additional Notes

- The application uses Prisma ORM for database operations
- All times are stored as percentages (0-100) in the database
- The urgency field uses an enum with values: HOT, MEDIUM, MILD
- Team members can have different working hours (default 40)
- Duplicate entries (same matter + task) are not allowed within a week+-- types/
¦   ¦   ¦   +-- models.ts
¦   ¦   +-- App.vue
¦   ¦   +-- main.ts
¦   +-- public/
¦   ¦   +-- index.html
¦   +-- package.json
¦   +-- tsconfig.json
¦   +-- quasar.conf.js
¦   +-- .env
+-- README.md